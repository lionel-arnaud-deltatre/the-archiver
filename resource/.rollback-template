name: Rollback <device_type> - <env>

on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Select version to rollback'
        required: true
        type: choice
        options:
          <versions_placeholder>

jobs:
  rollback:
    runs-on: ubuntu-latest
    steps:

      - name: Fetch archive and store it
        id: fetcharchive
        uses: lionel-arnaud-deltatre/the-archiver@main
        with:
          actionType: "fetch-archive"
          version: ${{ github.event.inputs.version }}
          appName: <project_name>
          deviceType: <device_type>
          environment: <env>
        env:
          PROJECT_AWS_ACCESS_KEY_ID: ${{ secrets.<project_access_key> }}
          PROJECT_AWS_SECRET_ACCESS_KEY: ${{ secrets.<project_secret> }}
          PROJECT_BUCKET_NAME: ${{ vars.<project_bucketname> }}
          PROJECT_ROOT_FOLDER: ${{ vars.<project_rootfolder> }}
          PROJECT_S3_REGION: ${{ vars.<project_s3region> }}   
          
          ARCHIVER_BUCKET_NAME: ${{ vars.ARCHIVER_BUCKET_NAME }}
          ARCHIVER_S3_REGION: ${{ vars.ARCHIVER_S3_REGION }}
          ARCHIVER_ROOT_FOLDER: ${{ vars.ARCHIVER_ROOT_FOLDER }}
          ARCHIVER_AWS_ACCESS_KEY_ID: ${{ secrets.ARCHIVER_AWS_ACCESS_KEY_ID }}
          ARCHIVER_AWS_SECRET_ACCESS_KEY: ${{ secrets.ARCHIVER_AWS_SECRET_ACCESS_KEY }}

      - name: Upload artifact in Github 
        uses: actions/upload-artifact@v4
        with:
          name: ${{ steps.fetcharchive.outputs.archiveName }}
          path: ${{ steps.fetcharchive.outputs.archivePath }}
          retention-days: 5
